### Курсовая работа по проектированию высоконагруженных систем
### _выполняет студент ИУ9-52Б Черников Артём_

## 1. Тема и целевая аудитория

## Сервис-аналог: Дзен

## Тип сервиса:
**Блог-платформа** для создания и просмотра контента (статьи, фото, видео).

## Функциональность MVP:
1. **Регистрация и авторизация пользователей**
2. **Публикация медиаконтента** (возможность загружать и публиковать статьи, фотографии, видео)
3. **Просмотр контента** (пользователи могут просматривать контент, найденный в поиске, на страницах других пользователей, среди рекомендованных публикаций, а также в избранном и истории просмотров)
4. **Подписки на пользователей** (возможность подписываться на интересующих пользователя авторов)
5. **Комментирование** (написание комментариев к публикациям и другим комментариям)

## Навигация:
- **Главная страница** (персонализированная лента с рекомендованными публикациями на основе интересов пользователя)
- **Подписки** (список авторов, на которых подписан пользователь)
- **Популярное** (публикации с наибольшим количеством просмотров за последнюю неделю)
- **Избранное** (список публикаций, отмеченных пользователем как избранные)
- **История** (список уже просмотренных пользователем публикаций)
- **Профиль** (раздел с информацией о пользователе и возможностью изменения некоторых данных)
- **Видео** (лента с видеоконтентом, подобранная на основе интересов пользователя)
- **Поиск** (поиск по всему контенту сервиса с возможностью фильтрации по тексту, заголовкам и популярным хештегам)

## Аудитория:
Платформой пользуются люди **от 12 до 80 лет**, при этом основная аудитория (**25-44 года**) составляет более половины пользователей. **60% пользователей** – женщины. Сервис посещают **80 млн человек ежемесячно** и **32 млн ежедневно**, причем **90% трафика** поступает из России и стран СНГ. **56% пользователей** заходят на платформу со смартфонов.

## Ключевые продуктовые решения:
- **Алгоритм подбора рекомендаций** на основе интересов пользователя (по хештегам, сервисным тегам)
- **Монетизация контента**
- **Возможность правки публикаций LLM**
- **Хештеги** (использование хештегов для классификации и поиска контента)
- **Шортсы** (короткие видео)


### Источники:
- https://inclient.ru/dzen-stats/
- https://alente.ru/blog/yandeksdzen-kak-platforma-dlya-formirovaniya-interesa-k-produktuusluge
---
## 2. Расчет нагрузки

### 2.1 Расчёт хранилища под одного пользователя

### 2.1a Видео

В 2023 году было загружено:
- **5 000 000 коротких видео**.
- **6 000 000 длинных видео**.
- Количество авторов видео: **500 000**.

В среднем на каждого активного автора приходится:
- **10 коротких видео** (5 000 000 / 500 000).
- **12 длинных видео** (6 000 000 / 500 000).

Исходя из данных о размерах видео:
- Короткие видео (до 2 минут) — **5 МБ**.
- Длинные видео — **4,5 ГБ**.

### Расчёт объёма хранилища на одного автора:
- **Короткие видео**: 10 видео * 5 МБ = **50 МБ**.
- **Длинные видео**: 12 видео * 4,5 ГБ = **54 ГБ**.

Итого на одного активного автора в 2023 выделяется **~54 ГБ** хранилища для видео. Посчитаем теперь за все годы, но для начала рассмотрим изменение количества авторов.

### Количество авторов по годам:

Количество активных авторов (тех, кто загружает видео) изменялось с годами. Примерно по следующим данным:
- **2019 год**: **70 000** авторов.
- **2020 год**: **100 000** авторов (из них **45 000** регулярно публиковали в неделю).
- **2021 год**: **200 000** авторов (из них **50 000** регулярно публиковали в неделю).
- **2022 год**: **400 000** авторов (из них **100 000** регулярно публиковали в неделю).
- **2023 год**: **500 000** авторов.

### Объём хранилища на одного автора за каждый год

Для расчёта объёма хранилища на одного активного автора в зависимости от года:
- **2019 год**: **4 ГБ/автора в год**.
- **2020 год**: **6 ГБ/автора в год**.
- **2021 год**: **30 ГБ/автора в год** (рост в 5 раз по сравнению с 2020 годом).
- **2022 год**: **35 ГБ/автора в год** (увеличение на 40% по сравнению с 2021 годом).
- **2023 год**: **54 ГБ/автора в год**.

### Объём хранилища для старых и новых пользователей
Если учитывать, что часть пользователей начала загружать видео с момента третьего квартала 2019 года, то расчёт хранилища для старых пользователей (авторов, которые были активны все годы) будет следующим:

- **2019**: **4 ГБ**.
- **2020**: **6 ГБ**.
- **2021**: **30 ГБ**.
- **2022**: **35 ГБ**.
- **2023**: **54 ГБ**.

Итого для старого пользователя, который был активен все годы: **129 ГБ**.

Для новых пользователей, которые начали загружать видео только в 2023 году, требуется **54 ГБ**.

Учитывая следующие данные:
- В **2023 году** было **500 000** активных авторов.
- В **2020 году** — **100 000** авторов.
- В **2019 году** — **70 000** авторов.
То .......

### Средний объём хранилища на одного активного автора

Учитывая прирост активных авторов по годам, можно рассчитать, что средний объём хранилища, выделенный на одного активного автора, составляет **около 80 ГБ**.

### Как рассчитан размер видео

- **Трафик для короткого видео**: 
  - **0,1 Гбит/с** (1 минута 45 секунд, 1000 битрейт) – **13 МБ**. 
  - После сжатия — **5 МБ**.
  
- **Трафик для длинного видео**:
  - **7,2 Гбит/с** (в среднем 4 часа, 5000 битрейт) – **9 ГБ**.
  - После сжатия кодеком **H.264** предполагается, что объём уменьшится в два раза — до **4,5 ГБ**.

## 2.1b

### Расчёт хранилища под одного пользователя для статей

### 1. Данные о статьях

В 2023 году было опубликовано:
- **20 000 000 постов**.
- **14 000 000 статей**.
- Количество авторов: **700 000**.

Значит, в среднем на каждого этого автора приходится:
- **29 постов**.
- **20 статей**.
Эти данные будем считать константыми и для других годов, ведь активность авторов особо не меняется.

### Сколько весит 1 статья:

1. **Текст** — **30 КБ**.
2. **Данные статьи** (метаданные, хештеги и прочее) — **5 КБ**.
3. **Картинки**: 
   - В статье в среднем **5 картинок**.
   - Ограничение на вес одной картинки — **30 МБ**, средний вес картинки — **5 МБ**.
   - Итого: **5 картинок * 5 МБ = 25 МБ**.
   - После сжатия: **10 МБ** на статью.

### Итого расчёт объёма хранилища для статьи:

- **Текст и данные**: 30 КБ + 5 КБ = **35 КБ**.
- **Картинки** (с учётом сжатия): **10 МБ**.

Итого, одна статья занимает **~10 МБ** хранилища.

### Сколько весит пост

1. **Текст** — **10 КБ**.
2. **Данные** — **5 КБ**.
3. **Картинка** (с учётом сжатия): **2 МБ**.

### Итого расчёт объёма хранилища для поста:
- **Текст и данные**: 10 КБ + 5 КБ = **15 КБ**.
- **Картинка**: **2 МБ**.

Итого, один пост занимает **~2100 КБ** (около 2,1 МБ).

## Объём хранилища на одного пользователя на один год

На одного пользователя приходится:
- **29 постов** * **2,1 МБ** = **~60,9 МБ** для постов.
- **20 статей** * **10 МБ** = **~200 МБ** для статей.

Итого на одного пользователя в год выделяется **~260 МБ** хранилища для контента (статей и постов) в год. Значит, с момента существования сервиса, у самого старого юзера будет 9 лет * 260МБ занимаемое хранилище, то есть, 2340МБ. Но это самый предельный усреднённый вариант, ведь большая часть авторов у Дзена появилась с 2021 по 2023 года. Значит, для расчёта возьмём с 2021 года: 3 * 260 = 780Мб в среднем занимает хранилище одного автора статей.

